# Instruction Document Creation Guide for Replit Agents
**Purpose**: AI Agent Template for Creating Comprehensive System Documentation  
**Version**: 1.0  
**Last Updated**: November 22, 2024  
**Status**: ACTIVE - FOUNDATIONAL TEMPLATE

## Overview for Replit Agents

This document provides comprehensive guidelines for Replit agents to create instruction documents that serve as the single source of truth for any system, feature, or functionality in the Rope Access Management System. As an AI agent, you must analyze the codebase thoroughly, understand system interactions, and document everything comprehensively for a production system handling safety-critical operations.

## Document Naming Convention

### Foundation Documents (Core, Unchanging)
- **Format**: `[NUMBER]. [TITLE_IN_CAPS].md`
- **Examples**:
  - `1. GUIDING_PRINCIPLES.md`
  - `2. INSTRUCTION_DOCUMENT_CREATION_GUIDE.md`
  - `3. DEPENDENCY-AWARENESS-INSTRUCTIONS.md`

### System/Feature Documents (Versioned, Evolving)
- **Format**: `[feature-name]-instructions-v[X.X].md`
- **Examples**:
  - `work-session-management-instructions-v1.0.md`
  - `gear-inventory-instructions-v2.1.md`
  - `safety-documentation-instructions-v1.3.md`

### Support Documents
- **Format**: Standard lowercase with hyphens
- **Examples**:
  - `documentation-roadmap.md`
  - `testing-checklist.md`
  - `deployment-guide.md`

## Versioning Standards

### Version Format
```
v[MAJOR].[MINOR]
```

### Version Increments
- **Major (1.0 → 2.0)**: Breaking changes, architectural shifts, complete rewrites
- **Minor (1.0 → 1.1)**: Feature additions, clarifications, non-breaking updates
- **Patch**: Not used - keep to two-level versioning for simplicity

### Version Header (Mandatory)
```markdown
# [Document Title] v[X.X]
**System**: Rope Access Management System
**Domain**: [Work Sessions | Safety | Gear | Employees | etc.]
**Version**: X.X
**Last Updated**: Month DD, YYYY
**Status**: [ACTIVE | DRAFT | DEPRECATED | PRODUCTION-READY ✅]
```

### Version History Section (Mandatory at End)
```markdown
## Version History
- **v2.0** (November 22, 2024): Complete refactor for multi-elevation tracking
- **v1.1** (November 15, 2024): Added GPS validation requirements
- **v1.0** (November 1, 2024): Initial release
```

## Agent Documentation Process

### Before Creating Documentation

As a Replit agent, you MUST complete these analysis steps:

1. **Search the codebase** for all files related to the system
2. **Read all relevant files** to understand implementation details
3. **Trace data flow** from user input through all processing to final storage
4. **Identify integration points** with other systems
5. **Find error handling patterns** and recovery mechanisms
6. **Locate configuration requirements** and environment variables
7. **Understand testing patterns** already in place
8. **Analyze multi-tenant isolation** for the feature
9. **Check safety implications** for rope access operations
10. **Complete System Impact Scan** (see Section 4)

### System Impact Scan

Before documenting ANY feature, complete this comprehensive scan:

```markdown
## System Impact Checklist
- [ ] Identified all database tables affected
- [ ] Traced all API endpoints involved
- [ ] Found all UI components that interact
- [ ] Listed all user roles that can access
- [ ] Verified multi-tenant isolation boundaries
- [ ] Checked impact on work session tracking
- [ ] Analyzed effect on safety documentation
- [ ] Reviewed payroll calculation implications
- [ ] Confirmed GPS/location data handling
- [ ] Validated offline functionality requirements
```

## Document Structure Template

Every instruction document MUST include these sections in this order:

### 1. Header Block
```markdown
# [System Name] Instructions v[X.X]
**System**: Rope Access Management System
**Domain**: [Primary domain area]
**Version**: [X.X]
**Last Updated**: [Month DD, YYYY]
**Status**: [ACTIVE | DRAFT | DEPRECATED | PRODUCTION-READY ✅]
**Safety Critical**: [Yes/No] - Whether failure affects worker safety
```

### 2. Purpose and Goal
```markdown
## Purpose and Goal

### Primary Objective
[Clear statement of what problem this solves for rope access operations]

### Key Goals
- **Safety**: [How it improves worker safety]
- **Efficiency**: [How it streamlines operations]
- **Compliance**: [What regulations it helps meet]
- **Accuracy**: [What data integrity it ensures]
- **Usability**: [How it helps field workers]
```

### 3. System Architecture
```markdown
## System Architecture

### Component Overview
[ASCII or Mermaid diagram showing system components]

### Data Flow
1. **Input Stage**: [User action or trigger]
2. **Validation Stage**: [Data validation and safety checks]
3. **Processing Stage**: [Business logic execution]
4. **Storage Stage**: [Database persistence]
5. **Output Stage**: [User feedback or downstream effects]

### Integration Points
- **Upstream Systems**: [What feeds data to this system]
- **Downstream Systems**: [What consumes this system's output]
- **Parallel Systems**: [What runs alongside]
```

### 4. Dependency Impact & Invariants
```markdown
## Dependency Impact & Invariants

### Non-negotiable Invariants
1. **[Invariant Name]**: [Rule that must never be violated]
   - Impact if violated: [Consequences]
   - Enforcement mechanism: [How system prevents violation]

### System Dependencies
- **Work Sessions**: [How this affects time tracking]
- **Safety Systems**: [Impact on inspections/documentation]
- **Payroll**: [Effect on time calculations]
- **Multi-tenant**: [Isolation requirements]
```

### 5. Technical Implementation
```markdown
## Technical Implementation

### Database Schema
```typescript
// Include relevant table definitions
```

### API Endpoints
- `POST /api/[endpoint]` - [Purpose]
- `GET /api/[endpoint]` - [Purpose]

### Critical Functions
```typescript
// Include key function signatures with comments
```
```

### 6. Multi-Tenant Considerations
```markdown
## Multi-Tenant Considerations

### Data Isolation
- **Company Level**: [How company data is isolated]
- **Employee Level**: [Role-based access patterns]
- **Resident Level**: [Resident data protection]

### Query Patterns
```typescript
// Always filter by companyId
const results = await db.query.tableName.findMany({
  where: eq(tableName.companyId, user.companyId)
});
```
```

### 7. Safety & Compliance
```markdown
## Safety & Compliance

### Safety-Critical Elements
- **[Element]**: [Why it's safety-critical]
- **Failure Mode**: [What happens if it fails]
- **Mitigation**: [How system prevents/handles failure]

### Regulatory Requirements
- **[Regulation]**: [How system ensures compliance]
- **Audit Trail**: [What's logged for compliance]
```

### 8. Field Worker Experience
```markdown
## Field Worker Experience

### Mobile Considerations
- **Touch Targets**: [Minimum sizes for gloved hands]
- **Offline Mode**: [What works without internet]
- **Data Sync**: [How offline data syncs]

### Common Workflows
1. **[Workflow Name]**: [Step-by-step field process]
```

### 9. Error Handling & Recovery
```markdown
## Error Handling & Recovery

### Common Errors
| Error | Cause | User Message | Recovery Action |
|-------|-------|--------------|-----------------|
| [Error] | [Why] | [What user sees] | [How to fix] |

### Graceful Degradation
- **No GPS**: [Fallback behavior]
- **No Internet**: [Offline mode]
- **Session Timeout**: [Recovery process]
```

### 10. Testing Requirements
```markdown
## Testing Requirements

### Unit Tests
```typescript
describe('[Feature]', () => {
  test('should [behavior]', () => {
    // Test pattern
  });
});
```

### Integration Tests
- **Multi-tenant isolation**: [Test company separation]
- **Role permissions**: [Test access control]
- **Data integrity**: [Test calculations]

### Field Testing
- **GPS accuracy**: [Location validation]
- **Offline sync**: [Data consistency]
- **Performance**: [Load time requirements]
```

### 11. Monitoring & Maintenance
```markdown
## Monitoring & Maintenance

### Key Metrics
- **[Metric]**: [Target value] - [Why it matters]
- **Alert Threshold**: [When to investigate]

### Regular Maintenance
- **Daily**: [What to check]
- **Weekly**: [What to verify]
- **Monthly**: [What to audit]
```

### 12. Troubleshooting Guide
```markdown
## Troubleshooting Guide

### Issue: [Problem Description]
**Symptoms**: [What users report]
**Diagnosis Steps**:
1. [Check this first]
2. [Then verify this]

**Solution**:
```bash
# Commands or code to fix
```

**Prevention**: [How to avoid recurrence]
```

### 13. Related Documentation
```markdown
## Related Documentation
- `work-session-management-instructions-v1.0.md` - [How it relates]
- `safety-documentation-instructions-v1.0.md` - [Connection points]
- `1. GUIDING_PRINCIPLES.md` - Core philosophy
```

### 14. Version History
```markdown
## Version History
- **v2.0** (November 22, 2024): Major refactor for multi-elevation
- **v1.1** (November 15, 2024): Added GPS validation
- **v1.0** (November 1, 2024): Initial release
```

## Agent Guidelines for Each Section

### When Writing "Purpose and Goal"
- **Connect to field operations**: How does this help workers on ropes?
- **Emphasize safety**: What safety improvements does it provide?
- **Show ROI**: Time saved, errors prevented, compliance achieved
- **Be specific**: Quantify improvements where possible

### When Writing "System Architecture"
- **Use visual aids**: ASCII diagrams for data flow
- **Show boundaries**: Clear multi-tenant isolation
- **Highlight critical paths**: What must never fail
- **Include timing**: Response time requirements

### When Writing "Technical Implementation"
- **Show real code**: Extract from actual implementation
- **Include types**: Full TypeScript definitions
- **Document gotchas**: Non-obvious requirements
- **Explain why**: Reasoning behind design decisions

### When Writing "Field Worker Experience"
- **Think mobile-first**: Small screens, touch input
- **Consider conditions**: Weather, gloves, heights
- **Prioritize speed**: Quick actions for safety
- **Plan for offline**: What works without internet

### When Writing "Testing Requirements"
- **Cover edge cases**: Unusual but possible scenarios
- **Test boundaries**: Multi-tenant isolation
- **Verify safety**: Critical features must work
- **Include performance**: Load and response times

## Document Quality Checklist

Before submitting any instruction document, verify:

### Content Completeness
- [ ] All 14 sections present and filled
- [ ] Version information accurate
- [ ] Status reflects document maturity
- [ ] Safety criticality assessed
- [ ] Code examples from actual implementation
- [ ] Error scenarios comprehensive
- [ ] Testing requirements specific
- [ ] Troubleshooting actionable

### Technical Accuracy
- [ ] Code snippets compile/run
- [ ] Database schemas match implementation
- [ ] API endpoints verified
- [ ] Multi-tenant patterns correct
- [ ] Safety mechanisms documented
- [ ] Performance requirements stated
- [ ] Monitoring metrics defined

### Clarity and Usability
- [ ] Purpose immediately clear
- [ ] Goals measurable
- [ ] Architecture diagram present
- [ ] Step-by-step procedures included
- [ ] Examples concrete and relevant
- [ ] Language clear and concise
- [ ] Cross-references accurate
- [ ] Version history complete

## Special Considerations for Rope Access Domain

### Safety-Critical Systems
When documenting features that affect worker safety:
- **Highlight failure modes**: What could go wrong
- **Document redundancies**: Backup systems
- **Specify audit requirements**: What must be logged
- **Include emergency procedures**: Incident response

### Field Operations
When documenting field-worker features:
- **Consider environmental factors**: Weather, heights
- **Plan for equipment limitations**: Gloves, harnesses
- **Design for speed**: Quick actions in dangerous conditions
- **Enable offline work**: Critical features without internet

### Regulatory Compliance
When documenting compliance features:
- **Cite specific regulations**: OSHA, IRATA, SPRAT
- **Show audit trails**: What's logged and retained
- **Document retention policies**: How long to keep records
- **Include report generation**: Compliance reporting

## Anti-Patterns to Avoid

### Documentation Anti-Patterns
❌ **Vague descriptions**: "It handles work sessions"
❌ **Missing code examples**: No actual implementation shown
❌ **Ignoring multi-tenant**: Not considering isolation
❌ **Skipping error handling**: Only happy path documented
❌ **Forgetting field workers**: Desktop-only thinking
❌ **Incomplete versioning**: No version history
❌ **Assuming knowledge**: Using jargon without explanation

### Correct Patterns
✅ **Specific descriptions**: "Tracks work sessions with GPS validation, elevation-specific drops, and automatic overtime calculation"
✅ **Real code examples**: Extracted from working implementation
✅ **Multi-tenant explicit**: Shows companyId filtering
✅ **Comprehensive errors**: All failure modes documented
✅ **Mobile-first design**: Field worker experience prioritized
✅ **Complete versioning**: Full change history
✅ **Clear explanations**: Technical terms defined

## Maintenance and Updates

### When to Update Documentation
- **Code changes**: Any modification to documented feature
- **Bug fixes**: That change behavior
- **Performance improvements**: That affect requirements
- **New integrations**: That create dependencies
- **Regulatory changes**: That affect compliance

### How to Update Documentation
1. **Increment version**: Major or minor as appropriate
2. **Update header**: Last updated date and status
3. **Modify affected sections**: Don't just append
4. **Update code examples**: Keep synchronized with code
5. **Add version history entry**: Describe changes
6. **Update related docs**: Cross-references may need updates
7. **Notify stakeholders**: If breaking changes

## Success Metrics for Documentation

### Good Documentation Results In:
- **Fewer support questions**: Developers find answers
- **Faster onboarding**: New team members productive quickly
- **Consistent implementation**: Everyone follows same patterns
- **Reduced bugs**: Edge cases considered upfront
- **Better testing**: Comprehensive test coverage
- **Easier maintenance**: Clear understanding of system

### Documentation Health Indicators
- **Up-to-date**: Matches current implementation
- **Complete**: All sections thoroughly filled
- **Clear**: Non-experts can understand
- **Actionable**: Provides specific steps
- **Tested**: Examples actually work
- **Referenced**: Other docs link to it

---

## Remember: Documentation Is Code

In a safety-critical system like rope access management, documentation is as important as code. Poor documentation can lead to:
- Implementation errors that compromise safety
- Inconsistent patterns that break multi-tenant isolation
- Missing error handling that loses critical data
- Performance problems that affect field workers
- Compliance violations that risk certifications

**Write documentation as carefully as you write code.**
**Review documentation as thoroughly as you review code.**
**Maintain documentation as diligently as you maintain code.**

Every instruction document you create becomes the foundation for system reliability, worker safety, and operational excellence.